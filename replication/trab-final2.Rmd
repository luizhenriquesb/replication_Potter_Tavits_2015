---
output: pdf_document
fontsize: 12pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = here::here())
```

```{r pacotes, warning=FALSE, message=FALSE}
library(tidyverse)
library(haven)
library(easystats)
library(foreign)
library(arm)
library(lmtest)
library(sandwich)
```

**Universidade de São Paulo**

**Falcudade de Filosofia, Letras e Ciências Humanas**

**Departamento de Ciência Política**

Disciplina: Métodos Quantitativos em Ciência Política IV

Docente: Prof. Dr. Manoel Galdino

Discente: Luiz Henrique da Silva Batista (Número USP: 12687228)

Tema: Replicação do artigo *O impacto das leis de financiamento de campanha na competição partidária* (Potter & Tavits, 2013).

**Introdução**

Este trabalho é uma replicação das análises de regressão linear realizadas por Potter e Tavits (2013) para embasarem a tese de que as leis de financiamento de campanha impactam a competição partidária. Os autores reconhecem que o tamanho do sistema partidário é afetado pelas regras eleitorais e as clivagens sociais, conforme boa parte da literatura têm mostrado. No entanto, defendem que, mesmo controlando pelas variáveis institucionais e sociológicas, o conjunto de regras que estruturam o financiamento de campanhas apresentam forte efeito preditivo na competição entre os partidos.

Para mensurar a relação entre essas duas variáveis, os autores sintetizam a noção de competição partidária no *Número Efetivo de Partidos* (NEP), desenvolvido por Laakso e Taagepera (1979) e Taagepera e Shugart (1989), e os regimes de financiamento de campanhas no conceito de *fund parity*. Este conceito busca caracterizar sistemas partidários que os autores chamam de *permissivos*, nos quais muitos partidos têm boas chances de ganhar espaço na legislatura, e *restritivos*, no quais poucos partidos têm tais chances. A métrica que desenvolveram para este conceito varia de -2 (sistema restritivo) até 4 (sistema permissivo), conforme os critérios definidos abaixo:

-   Se há limitação na quantidade de doação permitida (1), se não há limitação (0);

-   Se há limitação dos gastos de campanhas dos partidos (1), se não há limitação (0);

-   Se o acesso ao espaço na mídia é baseado no desempenho anterior do partido (-1), se o acesso é distribuído equitativamente (1), se o acesso não é permitido (0);

-   Se o financiamento público das camapnhas é baseado no desempenho anterior do partido (-1), se o financiamento público é distribuído equitativamente (1), se não tem financiamento público (0).

Assim, em síntese, o argumento dos autores é captar qual o efeito exclusivo do *fund parity*. Representando tal argumento em notação escalar, temos:

$$
NEP = \alpha + \beta_1 \cdot X_{Fund\ Parity} + \beta_2 \cdot X_2 +\ ...\ + \beta_k \cdot X_k + \epsilon
$$

**Descrição da base de dados**

A base de dados utilizada pelos autores contém informações sobre 124 países. Além do número efetivo de cada país, dos critérios para a construção do índice de paridade de financiamento e do próprio índice, a base armazena variáveis institucionais, como a forma do estado e o sistema de governo, e sociológicas, como as diferenças etnolinguísticas existentes no país.

Além disso, os dados correspondem a dois momentos no tempo: 2003 e 2012. Mas isso não para todos os países. Isso porque os dados foram coletados através de fontes variadas. O número efetivo de partidos, por exemplo, foi obtido através de Gallagher e Mitchell (2008), complementado por dados disponibilizados por Adam Carr e pela European Elections Database. Já as observações a respeito do regime de financiamento das campanhas foram obtidas por meio do Internacional IDEA, pesquisa conduzida por Austin e Tjersnstrom (2003). A descrição completa das variáveis pode ser acessada pelo codebook.

**Replicação dos resultados**

Os autores apresentam dois modelos no artigo. O primeiro deles com todas as democracias e o segundo somente com países que se tornaram democracias depois de 1974, recorte temporal justificado por ser uma das maneiras de se lidar com uma suposta endogeneidade dos dados. Voltaremos a isso mais a frente.

Esses dois modelos foram gerados removendo do dataset 3 (três) observações consideradas "outliers". São elas: Libéria (fund parity medido em 2012), Albânia (fund parity medido em 2003) e Brasil (fund parity medido em 2003). No entanto, os autores não deixam muito claro qual o método que utilizaram para a identificação dos outliers.

No código disponibilizado para replicação, somente temos a informação de como os outliers foram excluídos, mas não qual o critério. Trata-se de um comando para filtrar os países cujo número efetivo de partidos após as eleições fosse menor que 9.2.

Para identificar valores outliers, vamos utilizar três métodos.

```{r raw_data}
# Dados completos
raw_data <- read_dta("data/potter_tavits_data.dta")
```

**Análise dos outliers**

Analisamos os outliers através de três maneiras: 1) boxplot da variável *postenp*, 2) gráfico dos resíduos pelas observações influentes e 3) análise dos resíduos padronizados. O segundo e terceiro método analisa os outliers com base no modelo de regressão. Assim, o modelo que usamos foi o modelo 1 (all democracies) que os autores apresentam no artigo, sem a exlcusão, evidentemente, dos outliers, já que o propósito aqui é justamente identificá-los.

**1. Boxplot**

Os dois valores outliers do boxplot são `r round((boxplot(raw_data$postenp, plot = FALSE)$out[1]),1)` e `r round((boxplot(raw_data$postenp, plot = FALSE)$out[2]),1)`, os quais correspondem, respectivamente, a Albania (2003) e a Libéria (2012). Lembrando que, no R, o valor default para multiplicação do intervalo interquartil (IQR) é 1.5. Em outros softwares o padrão pode ser outro.

```{r boxplot, message=FALSE, warning=FALSE, fig.align='center', fig.width=3, fig.height=4, out.width="30%", out.height="40%"}
raw_data |>
  ggplot() +
  aes(y = postenp) +
  geom_boxplot(fill = "skyblue", coef = 1.50) +
  stat_boxplot(geom = "errorbar", width = 0.5) +
  theme_classic() +
  labs(
    title = "Boxplot da variável postenp",
  ) +
  scale_y_continuous(breaks = seq(0, 15, 1)) +
  theme(
    title = element_text(face = "bold", size = 10)
  )
```

**2. Gráfico dos resíduos pelas observações influentes**

Outra forma de analisar os outliers é através de uma análise gráfica dos resíduos pelas observações influentes. Aqui, é necessário primeiro rodar o modelo para depois plotar o gráfico.

```{r obs influentes, fig.align='center', fig.height=4, fig.width=6, out.height="40%", out.width="60%"}
# Modelo 1 (com os outliers)
full_raw_data <- lm(
  postenp ~ fundparity4
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = raw_data
)

plot(full_raw_data, which = 5)
```

No gráfico acima, valores considerados influentes deveriam aparecer depois da linha tracejada. Como é possível perceber, não existem valores influentes.

**3. Análise dos resíduos padronizados**

```{r residuos padronizados}
outliers <- which(rstandard(full_raw_data) > 2 | rstandard(full_raw_data) < -2)
paises_outliers <- raw_data[outliers, ] |> pull(cnty)
```

Em uma análise dos resíduos padronizados, são considerados valores outliers aqueles cujos resíduos padronizados forem maior que 2 ou menor que -2. Nesta análise, os países considerados outliers foram `r paste(paises_outliers, sep = ", ")`.

**Modelos apresentados no artigo**

Como foi dito acima, os dois modelos que os autores utilizaram na análise foram gerados a partir de uma base sem aqueles três países considerados "outliers", os quais apareceram na nossa análise de outliers sob métodos diferentes. A despeito disso, abaixo apresentamos os dois modelos apresentados pelos autores no paper, excluindo a Libéria, a Albânia e o Brasil.

```{r modelos, results='asis'}
# Dados sem os outliers
campaigns <- subset(raw_data, postenp < 9.2)

# Modelo 1 (all democracies)
full <- lm(
  postenp ~ fundparity4
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

# Dados sem outliers e somente com democracias pós-1974
later1974 <- subset(campaigns, demin > 1973)

# Modelo 2 (1974 and later)
post1974 <- lm(
  postenp ~ fundparity4
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = later1974
)

# Tabela com os dois modelos
stargazer::stargazer(full, post1974,
  type = "latex",
  style = "ajps",
  title = "Modelos apresentados na tabela 2",
  single.row = TRUE,
  keep.stat = c("n", "rsq"),
  dep.var.labels = "Competição partidária",
  header = FALSE,
  column.labels = c("Todas as democracias", "Pós-1974")
)
```

Os resultados da regressão estão de acordo com os resultados apresentados no artigo. A única diferença reside no fato de que os coeficientes apresentados nos artigos estão arredondados em duas casas decimais, enquanto aqui em três casas decimais. Mas são resultados essencialmente iguais.

**Modelos mencionados no artigo**

**1. Contribuição dos componentes da *fund parity* (nota 42)**

Na 42º nota de rodapé os autores buscam verificar se alguma das quatros variáveis que compõem o fund parity trabalha contra as outras três. Mas, como argumentam, de fato todas estão positivmaente associadas à paridade de fundos, embora somente a limitação da quantidade de doação permitida seja estatisticamente significativa.

```{r nota 42, results='asis'}
components <- lm(
  postenp ~ directelig
    + partyspend
    + donorlimit
    + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

stargazer::stargazer(components,
  type = "latex",
  style = "ajps",
  title = "Modelo da nota de rodapé 42 (1)",
  single.row = TRUE,
  keep.stat = c("n", "rsq"),
  dep.var.labels = "Competição partidária",
  header = FALSE,
  column.labels = "Model 1"
)
```

Os autores também afirmam que quando cada indicador da paridade de fundos é estimado individualmente, novamente somente coeficientes positivos são observados.

```{r nota 42.1, results='asis'}
# Modelo só com directelig
reg1 <- lm(
  postenp ~ directelig
    # + partyspend
    # + donorlimit
    # + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

# Modelo só com partyspend
reg2 <- lm(
  postenp ~ 
    # directelig
    + partyspend
    # + donorlimit
    # + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

# Modelo só com donorlimit
reg3 <- lm(
  postenp ~ 
    # directelig
    # + partyspend
    + donorlimit
    # + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

# Modelo só com eligmedia
reg4 <- lm(
  postenp ~ 
    # directelig
    # + partyspend
    # + donorlimit
    + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

stargazer::stargazer(reg1, reg2, reg3, reg4,
  type = "latex",
  style = "ajps",
  title = "Modelo da nota de rodapé 42 (2)",
  single.row = TRUE,
  keep.stat = c("n", "rsq"),
  dep.var.labels = "Competição partidária",
  header = FALSE,
  column.labels = c("directelig", "partyspend", "donorlimit", "eligmedia")
)
```

Também afirmam que quando os indicadores são apresentados de 3 (três) em 3 (três), novamente temos coeficientes positivos.

```{r nota 42.2, results='asis'}
# Modelo sem eligmedia
reg1 <- lm(
  postenp ~ directelig
    + partyspend
    + donorlimit
    # + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

# Modelo sem donorlimit
reg2 <- lm(
  postenp ~ 
    directelig
    + partyspend
    # + donorlimit
    + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

# Modelo sem partyspend
reg3 <- lm(
  postenp ~ 
    directelig
    # + partyspend
    + donorlimit
    + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

# Modelo sem directelig
reg4 <- lm(
  postenp ~ 
    # directelig
    + partyspend
    + donorlimit
    + eligmedia
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

stargazer::stargazer(reg1, reg2, reg3, reg4,
  type = "latex",
  style = "ajps",
  title = "Modelo da nota de rodapé 42 (3)",
  single.row = TRUE,
  keep.stat = c("n", "rsq"),
  dep.var.labels = "Competição partidária",
  header = FALSE,
  column.labels = c("-eligmedia", "-donorlimit", "-partyspend", "-directelig"),
  label = "tab:nota422"
)
```

**2. Diferenças entre as regras e a prática (nota 43)**

Na 43º nota de rodapé os autores chamam a atenção para as possíveis diferenças que podem existir entre as regras intitucionais e os efeitos dessas regras nas estratégias partidárias.

O debate surge em razão de uma possível diminuição do efeito preditor das leis de financiamento de campanham e países nos quais o nível de aplicação de leis fosse baixo, variável esta medida a partir de Indicadores de Governança Mundial do Banco Mundial.

Assim, os autores interagiram a variável *fundparity4* com a variável *rulelaw* (que mede o nível de aplicação das leis).

```{r nota 43, results='asis'}
rules.practice <- lm(
  postenp ~ fundparity4
    + rulelaw
    + fundparity4 * rulelaw
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

stargazer::stargazer(rules.practice,
  type = "latex",
  style = "ajps",
  title = "Modelo da nota de rodapé 43",
  single.row = TRUE,
  keep.stat = c("n", "rsq"),
  dep.var.labels = "Competição partidária",
  header = FALSE,
  column.labels = "Model 1",
  label = "tab:nota43"
)
```

Os autores argumentam que se a interação entre a paridade de fundos e a qualidade do Estado de direito fosse estatisticamente significativa, o impacto da paridade de fundos sobre a competição partidária tenderia a diminuir com menores nível de Estado de direito. De fato, como apresentam na nota de rodapé, essa relação não é estatisticamente significativa, mas caberia explicitar que ela não é significativa ao nível de 95% de confiança.

**3. Controlando pelo limiar eleitoral legal (nota 54)**

Neste modelo, os autores incluem a variável *thresh*, que mede o limiar eleitoral legal. Em conformidade com o que afirmam, de fato a inclusão dessa variável não afeta a *fund parity*, que continua estatistcamente significante.

```{r nota 54, results='asis'}
threshold <- lm(
  postenp ~ fundparity4
    + thresh
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

stargazer::stargazer(threshold,
  type = "latex",
  style = "ajps",
  title = "Modelo da nota de rodapé 54",
  single.row = TRUE,
  keep.stat = c("n", "rsq"),
  dep.var.labels = "Competição partidária",
  header = FALSE,
  column.labels = "Model 1",
  label = "tab:nota53"
)
```

**Lidando com a endogeneidade**

Os autores sugerem como direção causal que as regras de financiamento de campanham impactam a competição partidária, medida pelo número efetivo de partidos. Ou seja, argumentam que:
$$
Fund\ parity \to ENP
$$ 
No entanto, para demonstrar que a direção é realmente essa e não o contrário, isto é, $ENP \to Fund\ parity$ precisam rodar análises adicionais.

1.  Repetem a análise de regressão somente com países que se tornaram democracias recentemente, porque partem do pressuposto de que as regras de financiamento de campanham foram implementadas antes do sistema partidário ou de forma exógena a ele (caso das pressões exercidas por organizazções promotoras de democracia sobre as regras que deveriam ser adotadas). Essa é a razão pela qual rodaram um modelo somente com países democratizados após 1974.

Relação entre o NEP e a PARIDADE
Plotam essas duas varaiveis
Estimam uma regressao

```{r endogeneidade, fig.align='center', fig.height=4, fig.width=6, out.height="40%", out.width="60%", warning=FALSE}
raw_data |> 
  ggplot() +
  aes(x = preenp, y = fundparity4) +
  geom_point() +
  geom_smooth(method="lm", se=T) +
  theme_classic() +
  labs(
    # title = "",
    x = "Previous ENP",
    y = "Current Fund Parity Value"
  )
```
OBS: no codigo fornecido, eles fazem a analise usando campaigns, mas o grafico que eles apresentam no paper usa raw_data
