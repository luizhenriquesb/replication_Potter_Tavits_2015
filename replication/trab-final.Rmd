---
output: pdf_document
fontsize: 12pt
header-includes:
  - \usepackage{setspace}
  - \doublespacing
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = here::here())
```

::: {style="text-align: justify"}
```{r pacotes, warning=FALSE, message=FALSE}
library(tidyverse)
library(haven)
library(easystats)
library(foreign)
library(arm)
```

**Universidade de São Paulo**\
**Falcudade de Filosofia, Letras e Ciências Humanas**\
**Departamento de Ciência Política**\
Disciplina: Métodos Quantitativos em Ciência Política IV\
Docente: Prof. Dr. Manoel Galdino\
Discente: Luiz Henrique da Silva Batista (Número USP: 12687228)\
Tema: Replicação do artigo *O impacto das leis de financiamento de campanha na competição partidária* (Potter & Tavits, 2013).

**Introdução**

Este trabalho é uma replicação das análises de regressão linear realizadas por Potter e Tavits (2013) para embasarem a tese de que as leis de financiamento de campanha impactam a competição partidária. Os autores reconhecem que o tamanho do sistema partidário é afetado pelas regras eleitorais e as clivagens sociais, conforme boa parte da literatura têm mostrado. No entanto, defendem que, mesmo controlando pelas variáveis institucionais e sociológicas, o conjunto de regras que estruturam o financiamento de campanhas apresentam forte efeito preditivo na competição entre os partidos.

Para mensurar a relação entre essas duas variáveis, os autores sintetizam a noção de competição partidária no *Número Efetivo de Partidos* (NEP), desenvolvido por Laakso e Taagepera (1979) e Taagepera e Shugart (1989), e os regimes de financiamento de campanhas no conceito de *fund parity*. Este conceito busca caracterizar sistemas partidários que os autores chamam de *permissivos*, nos quais muitos partidos têm boas chances de ganhar espaço na legislatura, e *restritivos*, no quais poucos partidos têm tais chances. A métrica que desenvolveram para este conceito varia de -2 (sistema restritivo) até 4 (sistema permissivo), conforme os critérios definidos abaixo:

-   Se há limitação na quantidade de doação permitida (1), se não há limitação (0);

-   Se há limitação dos gastos de campanhas dos partidos (1), se não há limitação (0);

-   Se o acesso ao espaço na mídia é baseado no desempenho anterior do partido (-1), se o acesso é distribuído equitativamente (1), se o acesso não é permitido (0);

-   Se o financiamento público das camapnhas é baseado no desempenho anterior do partido (-1), se o financiamento público é distribuído equitativamente (1), se não tem financiamento público (0).

Assim, em síntese, o argumento dos autores é captar qual o efeito exclusivo do *fund parity*. Representando tal argumento em notação escalar, temos:

$$
NEP = \alpha + \beta_1 \cdot X_{Fund\ Parity} + \beta_2 \cdot X_2 +\ ...\ + \beta_k \cdot X_k + \epsilon
$$

**Descrição da base de dados**

A base de dados utilizada pelos autores contém informações sobre 124 países. Além do NEP de cada país, dos critérios para a construção do índice de paridade de financiamento e o próprio índice, a base armazena variáveis institucionais, como a forma do estado e o sistema de governo, e sociológicas, como as diferenças etnolinguísticas existentes no país.

Além disso, os dados foram coletados através de algumas fontes. O NEP, por exemplo, foi obtido através de Gallagher e Mitchell (2008), complementado por dados disponibilizados por Adam Carr e pela European Elections Database. Já as observações a respeito do regime de financiamento das campanhas foram obtidas por meio do Internacional IDEA, pesquisa conduzida por Austin e Tjersnstrom (2003). A descrição completa das variáveis pode ser acessada pelo codebook.

[TALVEZ FOSSE INTERESSANTE COLOCAR QUE EXISTEM DADOS DE 2003 E 2012]

**Replicação dos resultados**

Os autores apresentam dois modelos no artigo. O primeiro deles com todas as democracias e o segundo somente com países que se tornaram democracias depois de 1974, recorte temporal justificado por ser uma das maneiras de se lidar com uma suposta endogeneidade dos dados. Voltaremos a isso adiante. Esses dois modelos foram gerados removendo do dataset 3 (três) observações consideradas como outliers.

Abaixo, apresentamos os modelos apresentados no artigo.

```{r modelos 1 e 2 sem outliers, results='asis'}
# Dados completos
raw_data <- read_dta("data/potter_tavits_data.dta")

# Dados sem os outliers
campaigns <- subset(raw_data, postenp < 9.2)

# Modelo 1 (all democracies)
full <- lm(
  postenp ~ fundparity4
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = campaigns
)

# Dados sem outliers e somente com democracias pós-1974
later1974 <- subset(campaigns, demin > 1973)

# Modelo 2 (1974 and later)
post1974 <- lm(
  postenp ~ fundparity4
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = later1974
)

# Tabela com os dois modelos
stargazer::stargazer(full, post1974, 
                     type = "latex",
                     style = "ajps",
                     title = "Modelos apresentados na tabela 2",
                     single.row = FALSE,
                     keep.stat = c("n", "rsq"),
                     dep.var.labels = "Competição partidária",
                     header = FALSE,
                     column.labels = c("Todas as democracias", "Pós-1974")
                     )
```

Os resultados da regressão estão de acordo com os resultados apresentados no artigo. A única diferença reside no fato de que os coeficientes apresentados nos artigos estão arredondados em duas casas decimais, enquanto aqui em três casas decimais.

**Análise dos outliers**

Na regressão que os autores rodam, são excluídos três observações consideradas outliers. São elas: Liberia (fund parity medido em 2012), Albânia (fund parity medido em 2003) e Brasil (fund parity medido em 2003).

No artigo, não fica muito claro qual o método utilizado para a identificação dos outliers. No código disponibilizado para replicação, somente temos a informação de como os outliers foram excluídos, mas não qual o critério. Trata-se de um comando para filtrar os países cujo número efeitvo de partidos após as eleições fosse menor que 9.2.

Para identificar valores outliers, vamos utilizar três métodos.

*1. Boxplot*

Os dois valores outliers do boxplot são `r round((boxplot(raw_data$postenp, plot = FALSE)$out[1]),1)` e `r round((boxplot(raw_data$postenp, plot = FALSE)$out[2]),1)`, os quais correspondem, respectivamente, a Albania e a Libéria. Lembrando que, no R, o valor default para multiplicação do intervalo interquartil (IQR) é 1.5. Em outros softwares o padrão pode ser outro.

```{r fig.align='center'}
raw_data |> 
  ggplot() +
  aes(y = postenp, x = 1) +
  geom_boxplot(fill = "skyblue", coef = 1.50) +
  stat_boxplot(geom = "errorbar", width = 0.5) +
  theme_classic() +
  labs(
    title = "Boxplot da variável postenp",
  ) +
  scale_y_continuous(breaks = seq(0, 15, 1)) +
  theme(
    title = element_text(face = "bold", size = 10)
  )
```
*2. Gráfico dos resíduos pelas observações influentes*

Outra forma de aalisar os outliers é através de uma análise gráfica dos resíduos pelas observações influentes.
```{r, fig.align='center', fig.width=5, out.width="50%"}
# Modelo 1 (com os outliers)
full_raw_data <- lm(
  postenp ~ fundparity4
    + demyears
    + fed
    + pres
    + log(avemag)
    + fract
    + log(avemag):fract,
  data = raw_data
)

plot(full_raw_data, which = 5)
```
No gráfico acima, valores considerados influentes deveriam aparecer depois da linha tracejada. Como é possível perceber, não existem valores influentes.

*3. Análise dos resíduos padronizados*

```{r}
outliers <- which(rstandard(full_raw_data) > 2 | rstandard(full_raw_data) < - 2)
paises_outliers <- raw_data[outliers,] |> pull(cnty)
```
Aqui, são considerados valores outliers aqueles cujos resíduos padronizados forem maior que 2 ou menor que -2. Nesta análise, os países considerados outliers foram `r paste(paises_outliers, sep = ", ")`.


**Análise adicionais (checagem)**
:::
